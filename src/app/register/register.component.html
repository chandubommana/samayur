<h2 class="text-center my-4 fw-semibold text-secondary">
  Register as a Patient or Doctor
</h2>


<div class="d-flex justify-content-center gap-3 mb-4">
  <button type="button" class="btn"
    [ngClass]="selectedRole === 'patient' ? 'btn-primary' : 'btn-outline-primary'"
    (click)="setRole('patient')">
    ðŸ‘¤ Beneficiary
  </button>
  <button type="button" class="btn"
    [ngClass]="selectedRole === 'doctor' ? 'btn-primary' : 'btn-outline-primary'"
    (click)="setRole('doctor')">
    ðŸ©º Doctor
  </button>
</div>

<!-- Form -->
<div class="container bg-white p-4 rounded shadow-sm" style="max-width: 800px;">
  <form [formGroup]="form"  novalidate>
    
    <!-- First / Last Name -->
    <div class="row mb-3">
      <div class="col-md-6">
        <input type="text" class="form-control" placeholder="First Name"
          formControlName="first_name"
          [class.is-invalid]="submitted && f['first_name'].invalid" />
        <div class="invalid-feedback">First name is required.</div>
      </div>
      <div class="col-md-6">
        <input type="text" class="form-control" placeholder="Last Name"
          formControlName="last_name"
          [class.is-invalid]="submitted && f['last_name'].invalid" />
        <div class="invalid-feedback">Last name is required.</div>
      </div>
    </div>

  
    <div class="row mb-3">
      <div class="col-md-6">
        <input type="email" class="form-control" placeholder="Email"
          formControlName="email"
          [class.is-invalid]="submitted && f['email'].invalid" />
        <div class="invalid-feedback">Valid email is required.</div>
      </div>
      <div class="col-md-6">
        <input type="text" class="form-control" placeholder="Phone Number"
          formControlName="phone"
          [class.is-invalid]="submitted && f['phone'].invalid" />
        <div class="invalid-feedback">Phone number must be 10 digits.</div>
      </div>
    </div>

    <!-- Gender / DOB -->
    <div class="row mb-3">
      <div class="col-md-6">
        <select class="form-select" formControlName="gender"
          [class.is-invalid]="submitted && f['gender'].invalid">
          <option value="">Select Gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other</option>
        </select>
        <div class="invalid-feedback">Please select a gender.</div>
      </div>
      <div class="col-md-6">
        <input type="date" class="form-control" placeholder="Date of Birth"
          formControlName="dob"
          [class.is-invalid]="submitted && f['dob'].invalid" />
        <div class="invalid-feedback">Date of birth is required.</div>
      </div>
    </div>

    <!-- Location -->
    <div class="mb-3">
      <input type="text" class="form-control" placeholder="Location"
        formControlName="location"
        [class.is-invalid]="submitted && f['location'].invalid" />
      <div class="invalid-feedback">Location is required.</div>
    </div>

    <!-- Address -->
    <div class="mb-3">
      <textarea class="form-control" rows="3" placeholder="Address"
        formControlName="address"
        [class.is-invalid]="submitted && f['address'].invalid"></textarea>
      <div class="invalid-feedback">Address is required.</div>
    </div>

    <!-- Doctor Specific Fields -->
    <div *ngIf="selectedRole === 'doctor'">
      <div class="row mb-3">
        <div class="col-md-6">
          <input type="text" class="form-control" placeholder="Speciality"
            formControlName="speciality"
            [class.is-invalid]="submitted && f['speciality'].invalid" />
          <div class="invalid-feedback">Speciality is required.</div>
        </div>
        <div class="col-md-6">
          <input type="number" class="form-control" placeholder="Experience (Years)"
            formControlName="experience"
            [class.is-invalid]="submitted && f['experience'].invalid" />
          <div class="invalid-feedback">Experience is required.</div>
        </div>
      </div>
      <div class="mb-3">
        <textarea class="form-control" rows="3" placeholder="Past Experience Description"
          formControlName="description"
          [class.is-invalid]="submitted && f['description'].invalid"></textarea>
        <div class="invalid-feedback">Description is required.</div>
      </div>
    </div>

    <!-- Patient Specific Fields -->
    <div *ngIf="selectedRole === 'patient'">
      <div class="row mb-3">
        <div class="col-md-4">
          <select class="form-select" formControlName="marital_status">
            <option value="">Marital Status</option>
            <option value="single">Single</option>
            <option value="married">Married</option>
            <option value="divorced">Divorced</option>
          </select>
        </div>
        <div class="col-md-4">
          <input type="number" class="form-control" placeholder="Height (cm)"
            formControlName="height_cm"
            [class.is-invalid]="submitted && f['height_cm'].invalid" />
          <div class="invalid-feedback">Height is required.</div>
        </div>
        <div class="col-md-4">
          <input type="number" class="form-control" placeholder="Weight (kg)"
            formControlName="weight_kg"
            [class.is-invalid]="submitted && f['weight_kg'].invalid" />
          <div class="invalid-feedback">Weight is required.</div>
        </div>
      </div>

      <div class="mb-3">
        <textarea class="form-control" rows="3" placeholder="Current Illness"
          formControlName="current_illness"
          [class.is-invalid]="submitted && f['current_illness'].invalid"></textarea>
        <div class="invalid-feedback">Please provide current illness details.</div>
      </div>

      <!-- Appointment Picker -->
      <div class="mb-3">
        <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#calendarModal">
          ðŸ“… Select Appointment
        </button>

        <input type="datetime-local" class="form-control mt-2"
          formControlName="appointment_request"
          [value]="selectedDateTime"
          readonly
          [class.is-invalid]="submitted && f['appointment_request'].invalid" />
        <div class="invalid-feedback">Please select an appointment date/time.</div>
      </div>
    </div>

    
    <div class="d-flex align-item-center justify-content-center mt-2">
      <button type="submit" class="btn btn-success" (click)="onSubmit()">Register</button>
    </div>
  </form>

 
  <!-- Success Message -->
<!-- Success Message -->
<div *ngIf="displaymessage"
     class="alert alert-success alert-dismissible fade show position-fixed top-0 end-0 m-3 shadow"
     role="alert"
     style="z-index: 1055; min-width: 250px;">
  âœ… Thank you! We'll get back to you shortly.
  <button type="button" class="btn-close" (click)="closeMessage()" aria-label="Close"></button>
</div>


</div>




<!-- Modal wrapper -->
<!-- Trigger button -->


<!-- Modal -->
<!-- Appointment Modal -->
<div class="modal fade" id="calendarModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="false">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <app-appointment-booking (dateTimeSelected)="onDateTimeSelected($event)"></app-appointment-booking>
    </div>
  </div>
</div>





